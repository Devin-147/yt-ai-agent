<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>YT AI Agent</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-black text-white min-h-screen flex items-center justify-center p-4">
  <div class="w-full max-w-3xl">
    <h1 class="text-5xl font-bold text-center bg-gradient-to-r from-purple-400 to-pink-500 bg-clip-text text-transparent mb-8">
      YT AI Agent
    </h1>
    <textarea id="urls" rows="8" class="w-full p-6 text-lg bg-gray-900 rounded-xl focus:outline-none focus:ring-4 focus:ring-purple-600"
      placeholder="Paste YouTube URLs, one per line (max 10)"></textarea>
    <button onclick="go()" class="mt-6 w-full py-5 text-xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 rounded-xl hover:from-purple-700 hover:to-pink-700">
      Generate Script
    </button>
    <div id="out" class="mt-10 text-lg"></div>
  </div>

  <script>
    async function go() {
      const urls = document.getElementById('urls').value.trim().split('\n').filter(x => x.trim());
      const out = document.getElementById('out');
      const btn = document.querySelector('button');
      if (!urls.length) return out.innerHTML = "<p class='text-red-500'>Paste at least one URL</p>";

      out.innerHTML = "<p>Working… (15–60 sec)</p>";
      btn.disabled = true;

      try {
        const res = await fetch("/api", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ urls })
        });
        const json = await res.json();
        if (json.success) {
          out.innerHTML = `<pre class="bg-gray-900 p-8 rounded-xl overflow-x-auto">${json.finalScript}</pre>`;
        } else {
          out.innerHTML = `<p class="text-red-500">Error: ${json.error}</p>`;
        }
      } catch (e) {
        out.innerHTML = `<p class="text-red-500">Network error: ${e.message}</p>`;
      }
      btn.disabled = false;
    }
  </script>
</body>
</html>
